<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bubble Sort Animation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .array-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
            position: relative;
            height: 180px;
        }
        .element {
            width: 50px;
            height: 50px;
            background-color: #4CAF50;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 5px;
            border-radius: 5px;
            font-size: 18px;
            position: relative;
            transition: all 0.5s ease;
        }
        .comparing {
            background-color: #FFC107;
            transform: translateY(-10px);
        }
        .swapping {
            background-color: #F44336;
        }
        .sorted {
            background-color: #3F51B5;
        }
        .controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        button {
            padding: 8px 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        button:hover {
            background-color: #45a049;
        }
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .arrow {
            position: absolute;
            top: 70px;
            font-size: 24px;
            color: #F44336;
            transition: all 0.5s ease;
        }
        .step-info {
            text-align: center;
            margin: 15px 0;
            min-height: 60px;
            padding: 10px;
            background-color: #e9f7ef;
            border-radius: 5px;
        }
        .progress-container {
            margin-top: 20px;
            text-align: center;
        }
        .progress-bar {
            height: 5px;
            background-color: #ddd;
            border-radius: 5px;
            margin-bottom: 10px;
            overflow: hidden;
        }
        .progress {
            height: 100%;
            background-color: #4CAF50;
            width: 0%;
            transition: width 0.3s;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Bubble Sort Animation</h1>
        <p>
            Bubble Sort works by repeatedly stepping through the list, comparing adjacent elements, 
            and swapping them if they are in the wrong order. This process is repeated until the list is sorted.
        </p>
        <div class="step-info" id="stepInfo">
            Initial array: [5, 3, 8, 4, 2]
        </div>
        <div class="array-container" id="arrayContainer"></div>
        <div class="controls">
            <button id="prevBtn" disabled>Previous</button>
            <button id="nextBtn">Next</button>
        </div>
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress" id="progressBar"></div>
            </div>
            <div id="progressText">Step 0 of 0</div>
        </div>
    </div>

    <script>
        const initialArray = [5, 3, 8, 4, 2];
        let currentArray = [...initialArray];
        let animations = [];
        let currentStep = 0;

        // Generate all steps of bubble sort
        function generateBubbleSortSteps(arr) {
            const steps = [];
            const n = arr.length;
            const arrCopy = [...arr];
            
            // Initial state
            steps.push({
                array: [...arrCopy],
                action: 'initial',
                comparing: [],
                swapping: [],
                sorted: []
            });

            // Generate all comparison and swap steps
            for (let i = 0; i < n - 1; i++) {
                for (let j = 0; j < n - i - 1; j++) {
                    // Comparison step
                    steps.push({
                        array: [...arrCopy],
                        action: 'compare',
                        comparing: [j, j + 1],
                        description: `Comparing ${arrCopy[j]} and ${arrCopy[j + 1]}`,
                        sorted: Array.from({length: n - i}, (_, k) => n - 1 - k)
                    });

                    // If elements need swapping
                    if (arrCopy[j] > arrCopy[j + 1]) {
                        // Swap in our copy
                        [arrCopy[j], arrCopy[j + 1]] = [arrCopy[j + 1], arrCopy[j]];
                        
                        // Add swap step
                        steps.push({
                            array: [...arrCopy],
                            action: 'swap',
                            swapping: [j, j + 1],
                            description: `Swapping ${arrCopy[j+1]} and ${arrCopy[j]}`,
                            sorted: Array.from({length: n - i}, (_, k) => n - 1 - k)
                        });
                    } else {
                        // No swap needed
                        steps.push({
                            array: [...arrCopy],
                            action: 'no-swap',
                            comparing: [j, j + 1],
                            description: `No swap needed (${arrCopy[j]} â‰¤ ${arrCopy[j + 1]})`,
                            sorted: Array.from({length: n - i}, (_, k) => n - 1 - k)
                        });
                    }
                }
                
                // After each pass, the largest element is at the end
                if (i < n - 2) {
                    steps.push({
                        array: [...arrCopy],
                        action: 'pass-complete',
                        description: `Pass ${i+1} complete. Largest ${i+1} element${i > 0 ? 's are' : ' is'} now at the end.`,
                        sorted: Array.from({length: n - i}, (_, k) => n - 1 - k)
                    });
                }
            }

            // Final sorted state
            steps.push({
                array: [...arrCopy],
                action: 'sorted',
                description: 'Array is now fully sorted!',
                sorted: Array.from({length: n}, (_, i) => i)
            });

            return steps;
        }

        // Initialize the visualization
        function init() {
            const arrayContainer = document.getElementById('arrayContainer');
            arrayContainer.innerHTML = '';
            
            // Create initial array elements
            initialArray.forEach((value, index) => {
                const element = document.createElement('div');
                element.className = 'element';
                element.id = `element-${index}`;
                element.textContent = value;
                arrayContainer.appendChild(element);
            });

            // Generate all animation steps
            animations = generateBubbleSortSteps(initialArray);
            updateProgressBar();
        }

        // Update the visualization based on current step
        function updateVisualization() {
            const step = animations[currentStep];
            const stepInfo = document.getElementById('stepInfo');
            
            // Update all elements
            step.array.forEach((value, index) => {
                const element = document.getElementById(`element-${index}`);
                element.textContent = value;
                
                // Reset all classes first
                element.className = 'element';
                
                // Add appropriate classes based on current step
                if (step.comparing && step.comparing.includes(index)) {
                    element.classList.add('comparing');
                }
                if (step.swapping && step.swapping.includes(index)) {
                    element.classList.add('swapping');
                }
                if (step.sorted && step.sorted.includes(index)) {
                    element.classList.add('sorted');
                }
            });

            // Update step description
            stepInfo.textContent = step.description || `Step ${currentStep} of ${animations.length - 1}`;
            
            // Update buttons
            document.getElementById('prevBtn').disabled = currentStep === 0;
            document.getElementById('nextBtn').disabled = currentStep === animations.length - 1;
            
            // Update progress
            updateProgressBar();
        }

        function updateProgressBar() {
            const progressPercent = (currentStep / (animations.length - 1)) * 100;
            document.getElementById('progressBar').style.width = `${progressPercent}%`;
            document.getElementById('progressText').textContent = `Step ${currentStep} of ${animations.length - 1}`;
        }

        // Event listeners for buttons
        document.getElementById('nextBtn').addEventListener('click', () => {
            if (currentStep < animations.length - 1) {
                currentStep++;
                updateVisualization();
            }
        });

        document.getElementById('prevBtn').addEventListener('click', () => {
            if (currentStep > 0) {
                currentStep--;
                updateVisualization();
            }
        });

        // Initialize on load
        window.onload = () => {
            init();
            updateVisualization();
        };
    </script>
</body>
</html>