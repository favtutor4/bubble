<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bubble Sort with Early Termination Visualization</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
        }
        .visualization-container {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        .sort-container {
            width: 48%;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background-color: #fff;
        }
        .sort-title {
            text-align: center;
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 18px;
            color: #3498db;
        }
        .array-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            height: 250px;
            align-items: flex-end;
        }
        .bar {
            width: 40px;
            margin: 0 5px;
            background-color: #3498db;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 5px 5px 0 0;
            position: relative;
            transition: background-color 0.3s;
        }
        .bar-value {
            position: absolute;
            top: -25px;
            font-weight: bold;
        }
        .description {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
            min-height: 100px;
        }
        .navigation {
            display: flex;
            justify-content: center;
            margin-top: 30px;
            gap: 20px;
        }
        .nav-btn {
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .nav-btn:hover {
            background-color: #2980b9;
        }
        .nav-btn:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
        .comparison-highlight {
            background-color: #e74c3c !important;
        }
        .sorted {
            background-color: #2ecc71;
        }
        .swapped {
            background-color: #f39c12;
        }
        .iteration-counter {
            text-align: center;
            font-weight: bold;
            margin-top: 10px;
            color: #7f8c8d;
        }
        .early-termination {
            background-color: #fde2e2;
            border: 2px dashed #e74c3c;
        }
        .status-indicator {
            margin-top: 10px;
            text-align: center;
            font-weight: bold;
        }
        .finished {
            color: #27ae60;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Bubble Sort with Early Termination Visualization</h1>
        
        <div class="visualization-container">
            <!-- Standard Bubble Sort -->
            <div class="sort-container">
                <div class="sort-title">Standard Bubble Sort</div>
                <div id="standard-array" class="array-container"></div>
                <div id="standard-iteration" class="iteration-counter">Iteration: 0</div>
                <div id="standard-status" class="status-indicator"></div>
                <div id="standard-description" class="description">
                    Standard bubble sort always completes all iterations, even if the array becomes sorted early.
                </div>
            </div>
            
            <!-- Optimized Bubble Sort with Early Termination -->
            <div class="sort-container">
                <div class="sort-title">Optimized Bubble Sort (Early Termination)</div>
                <div id="optimized-array" class="array-container"></div>
                <div id="optimized-iteration" class="iteration-counter">Iteration: 0</div>
                <div id="optimized-status" class="status-indicator"></div>
                <div id="optimized-description" class="description">
                    Optimized bubble sort stops early when no swaps are needed, saving unnecessary operations.
                </div>
            </div>
        </div>
        
        <div class="navigation">
            <button id="prevBtn" class="nav-btn" disabled>Previous</button>
            <button id="nextBtn" class="nav-btn">Next</button>
        </div>
    </div>

    <script>
        // Initial array
        const originalArray = [1, 2, 4, 3, 5, 6];
        
        // Animation steps
        let steps = [];
        let currentStep = 0;
        
        // Generate steps for both sorts
        generateSortSteps(originalArray);
        
        // Initialize visualization
        initializeArrays(originalArray);
        
        // Navigation buttons
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        
        prevBtn.addEventListener('click', () => {
            currentStep--;
            updateVisualization();
            updateNavButtons();
        });
        
        nextBtn.addEventListener('click', () => {
            currentStep++;
            updateVisualization();
            updateNavButtons();
        });
        
        function updateNavButtons() {
            prevBtn.disabled = currentStep === 0;
            nextBtn.disabled = currentStep === steps.length - 1;
        }
        
        function initializeArrays(arr) {
            const standardArray = document.getElementById('standard-array');
            const optimizedArray = document.getElementById('optimized-array');
            
            standardArray.innerHTML = '';
            optimizedArray.innerHTML = '';
            
            for (let i = 0; i < arr.length; i++) {
                // Standard array bars
                const standardBar = document.createElement('div');
                standardBar.className = 'bar';
                standardBar.style.height = `${arr[i] * 40}px`;
                
                const standardValueLabel = document.createElement('div');
                standardValueLabel.className = 'bar-value';
                standardValueLabel.textContent = arr[i];
                
                standardBar.appendChild(standardValueLabel);
                standardArray.appendChild(standardBar);
                
                // Optimized array bars
                const optimizedBar = document.createElement('div');
                optimizedBar.className = 'bar';
                optimizedBar.style.height = `${arr[i] * 40}px`;
                
                const optimizedValueLabel = document.createElement('div');
                optimizedValueLabel.className = 'bar-value';
                optimizedValueLabel.textContent = arr[i];
                
                optimizedBar.appendChild(optimizedValueLabel);
                optimizedArray.appendChild(optimizedBar);
            }
        }
        
        function generateSortSteps(arr) {
            steps = [];
            
            // Initial state
            steps.push({
                standard: {
                    array: [...arr],
                    comparing: null,
                    swapped: false,
                    iteration: 0,
                    status: 'Starting standard bubble sort'
                },
                optimized: {
                    array: [...arr],
                    comparing: null,
                    swapped: false,
                    iteration: 0,
                    status: 'Starting optimized bubble sort'
                },
                description: {
                    standard: 'We will begin the standard bubble sort algorithm on the array [1, 2, 4, 3, 5, 6].',
                    optimized: 'We will begin the optimized bubble sort algorithm on the array [1, 2, 4, 3, 5, 6].'
                }
            });
            
            // Create copies of the array for both sorts
            let standardArray = [...arr];
            let optimizedArray = [...arr];
            
            // Track iteration numbers
            let standardIteration = 1;
            let optimizedIteration = 1;
            
            // Track if the optimized sort has terminated early
            let optimizedTerminated = false;
            
            // For each pass through the array
            for (let i = 0; i < arr.length - 1; i++) {
                let standardSwapMade = false;
                let optimizedSwapMade = false;
                
                // For each comparison in this pass
                for (let j = 0; j < arr.length - i - 1; j++) {
                    // Standard sort comparison
                    steps.push({
                        standard: {
                            array: [...standardArray],
                            comparing: [j, j+1],
                            swapped: false,
                            iteration: standardIteration,
                            status: `Comparing elements at positions ${j} and ${j+1}`
                        },
                        optimized: {
                            array: [...optimizedArray],
                            comparing: optimizedTerminated ? null : [j, j+1],
                            swapped: false,
                            iteration: optimizedIteration,
                            status: optimizedTerminated ? 'Early termination activated' : `Comparing elements at positions ${j} and ${j+1}`
                        },
                        description: {
                            standard: `Comparing ${standardArray[j]} and ${standardArray[j+1]}`,
                            optimized: optimizedTerminated ? 
                                      'No swaps were made in the previous pass, so the array is already sorted. The algorithm can terminate early.' :
                                      `Comparing ${optimizedArray[j]} and ${optimizedArray[j+1]}`
                        }
                    });
                    
                    // If standard sort needs to swap
                    if (standardArray[j] > standardArray[j+1]) {
                        [standardArray[j], standardArray[j+1]] = [standardArray[j+1], standardArray[j]];
                        standardSwapMade = true;
                        
                        steps.push({
                            standard: {
                                array: [...standardArray],
                                comparing: [j, j+1],
                                swapped: true,
                                iteration: standardIteration,
                                status: `Swapped ${standardArray[j+1]} and ${standardArray[j]}`
                            },
                            optimized: {
                                array: [...optimizedArray],
                                comparing: optimizedTerminated ? null : [j, j+1],
                                swapped: false,
                                iteration: optimizedIteration,
                                status: optimizedTerminated ? 'Early termination activated' : `Comparing elements at positions ${j} and ${j+1}`
                            },
                            description: {
                                standard: `${standardArray[j+1]} > ${standardArray[j]}, so we swap them.`,
                                optimized: optimizedTerminated ? 
                                          'The optimized sort has already finished because the array was sorted.' :
                                          `Comparing ${optimizedArray[j]} and ${optimizedArray[j+1]}`
                            }
                        });
                    }
                    
                    // If optimized sort needs to swap (and hasn't terminated)
                    if (!optimizedTerminated && optimizedArray[j] > optimizedArray[j+1]) {
                        [optimizedArray[j], optimizedArray[j+1]] = [optimizedArray[j+1], optimizedArray[j]];
                        optimizedSwapMade = true;
                        
                        steps.push({
                            standard: {
                                array: [...standardArray],
                                comparing: [j, j+1],
                                swapped: false,
                                iteration: standardIteration,
                                status: standardSwapMade ? `Swapped ${standardArray[j]} and ${standardArray[j+1]}` : `Comparing elements at positions ${j} and ${j+1}`
                            },
                            optimized: {
                                array: [...optimizedArray],
                                comparing: [j, j+1],
                                swapped: true,
                                iteration: optimizedIteration,
                                status: `Swapped ${optimizedArray[j+1]} and ${optimizedArray[j]}`
                            },
                            description: {
                                standard: standardSwapMade ? 
                                          `${standardArray[j+1]} > ${standardArray[j]}, so we swap them.` :
                                          `${standardArray[j]} <= ${standardArray[j+1]}, no swap needed.`,
                                optimized: `${optimizedArray[j+1]} > ${optimizedArray[j]}, so we swap them.`
                            }
                        });
                    }
                }
                
                // End of a pass
                standardIteration++;
                
                // If optimized sort didn't make any swaps, it can terminate early
                if (!optimizedTerminated && !optimizedSwapMade) {
                    optimizedTerminated = true;
                    
                    steps.push({
                        standard: {
                            array: [...standardArray],
                            comparing: null,
                            swapped: false,
                            iteration: standardIteration,
                            status: `Starting iteration ${standardIteration}`
                        },
                        optimized: {
                            array: [...optimizedArray],
                            comparing: null,
                            swapped: false,
                            iteration: optimizedIteration,
                            status: 'Early termination activated',
                            earlyTermination: true
                        },
                        description: {
                            standard: `Completed pass ${standardIteration-1}. The standard bubble sort continues with the next pass.`,
                            optimized: `No swaps were made during the last pass. The array is now sorted, so we can terminate early after just ${optimizedIteration} passes instead of the full ${arr.length-1} passes that standard bubble sort will complete.`
                        }
                    });
                } else if (!optimizedTerminated) {
                    optimizedIteration++;
                    
                    steps.push({
                        standard: {
                            array: [...standardArray],
                            comparing: null,
                            swapped: false,
                            iteration: standardIteration,
                            status: `Starting iteration ${standardIteration}`
                        },
                        optimized: {
                            array: [...optimizedArray],
                            comparing: null,
                            swapped: false,
                            iteration: optimizedIteration,
                            status: `Starting iteration ${optimizedIteration}`
                        },
                        description: {
                            standard: `Completed pass ${standardIteration-1}. Moving to the next pass.`,
                            optimized: `Completed pass ${optimizedIteration-1}. Moving to the next pass.`
                        }
                    });
                }
            }
            
            // Final state
            steps.push({
                standard: {
                    array: [...standardArray],
                    comparing: null,
                    swapped: false,
                    iteration: standardIteration,
                    status: 'Sorting complete',
                    finished: true
                },
                optimized: {
                    array: [...optimizedArray],
                    comparing: null,
                    swapped: false,
                    iteration: optimizedIteration,
                    status: 'Sorting complete',
                    finished: true,
                    earlyTermination: optimizedTerminated
                },
                description: {
                    standard: `Standard bubble sort completed after ${standardIteration-1} full passes through the array.`,
                    optimized: optimizedTerminated ? 
                              `Optimized bubble sort completed early after only ${optimizedIteration-1} passes through the array, saving ${(arr.length-1) - (optimizedIteration-1)} passes.` :
                              `Optimized bubble sort completed after ${optimizedIteration-1} passes through the array.`
                }
            });
        }
        
        function updateVisualization() {
            const step = steps[currentStep];
            
            // Update standard array
            updateArrayDisplay('standard', step.standard);
            
            // Update optimized array
            updateArrayDisplay('optimized', step.optimized);
            
            // Update descriptions
            document.getElementById('standard-description').textContent = step.description.standard;
            document.getElementById('optimized-description').textContent = step.description.optimized;
        }
        
        function updateArrayDisplay(type, state) {
            const arrayContainer = document.getElementById(`${type}-array`);
            const bars = arrayContainer.getElementsByClassName('bar');
            
            // Update each bar
            for (let i = 0; i < state.array.length; i++) {
                bars[i].style.height = `${state.array[i] * 40}px`;
                bars[i].classList.remove('comparison-highlight', 'swapped', 'sorted');
                
                const valueLabel = bars[i].querySelector('.bar-value');
                valueLabel.textContent = state.array[i];
            }
            
            // Add comparison highlighting
            if (state.comparing) {
                state.comparing.forEach(index => {
                    bars[index].classList.add('comparison-highlight');
                });
            }
            
            // Add swap highlighting
            if (state.swapped && state.comparing) {
                state.comparing.forEach(index => {
                    bars[index].classList.add('swapped');
                });
            }
            
            // Update iteration counter
            document.getElementById(`${type}-iteration`).textContent = `Iteration: ${state.iteration}`;
            
            // Update status
            const statusElement = document.getElementById(`${type}-status`);
            statusElement.textContent = state.status;
            statusElement.className = 'status-indicator';
            
            if (state.finished) {
                statusElement.classList.add('finished');
            }
            
            // Add early termination indicator
            const container = document.getElementById(`${type}-array`).parentElement;
            if (state.earlyTermination) {
                container.classList.add('early-termination');
            } else {
                container.classList.remove('early-termination');
            }
        }
        
        // Initialize visualization with first step
        updateVisualization();
        updateNavButtons();
    </script>
</body>
</html>