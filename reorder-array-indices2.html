<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cycle-Following Technique Animation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #FFFFFF;
            color: #000000;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }
        h1 {
            color: #FF4800;
            margin-bottom: 30px;
        }
        .array-container {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            position: relative;
        }
        .element {
            width: 50px;
            height: 50px;
            margin: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid #FF4800;
            border-radius: 5px;
            background-color: #FFFFFF;
            font-weight: bold;
            position: relative;
            transition: all 0.5s ease;
        }
        .index {
            position: absolute;
            bottom: -25px;
            font-size: 14px;
            width: 100%;
            text-align: center;
        }
        .highlighted {
            background-color: #FD9F78;
        }
        .controls {
            margin-top: 40px;
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        button {
            padding: 10px 20px;
            background-color: #FF4800;
            color: #FFFFFF;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #FD9F78;
        }
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .description {
            margin: 30px 0;
            padding: 15px;
            border: 1px solid #FD9F78;
            border-radius: 8px;
            text-align: left;
            line-height: 1.6;
        }
        .step-counter {
            font-weight: bold;
            color: #FF4800;
            margin-bottom: 10px;
        }
        .arrow {
            position: absolute;
            width: 30px;
            height: 30px;
            top: 60px;
            color: #FF4800;
            font-size: 24px;
        }
        .cycle-indicator {
            margin-top: 30px;
            color: #FF4800;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Cycle-Following Technique</h1>
        
        <div class="description">
            <div class="step-counter">Step: <span id="step-counter">0</span> of 11</div>
            <div id="explanation">The Cycle-Following Technique is used to rearrange elements in an array in place. Let's see how it works with the array [5, 3, 2, 1, 4] and target indices [4, 0, 1, 2, 3].</div>
        </div>

        <div class="cycle-indicator" id="cycle-indicator"></div>
        
        <div class="array-container" id="array-container">
            <!-- Array elements will be generated by JavaScript -->
        </div>
        
        <div class="controls">
            <button id="prev-btn" disabled>Previous</button>
            <button id="next-btn">Next</button>
        </div>
    </div>

    <script>
        // Initial array and desired indices
        const originalArray = [5, 3, 2, 1, 4];
        const targetIndices = [4, 0, 1, 2, 3];
        
        // Animation state
        let currentStep = 0;
        const totalSteps = 11;
        let elementPositions = [...originalArray];
        
        // Elements for DOM manipulation
        const arrayContainer = document.getElementById('array-container');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const stepCounter = document.getElementById('step-counter');
        const explanation = document.getElementById('explanation');
        const cycleIndicator = document.getElementById('cycle-indicator');
        
        // Create initial array visualization
        function createArrayElements() {
            arrayContainer.innerHTML = '';
            elementPositions.forEach((value, index) => {
                const element = document.createElement('div');
                element.className = 'element';
                element.id = `element-${index}`;
                element.textContent = value;
                
                const indexElem = document.createElement('div');
                indexElem.className = 'index';
                indexElem.textContent = `Index: ${index}`;
                
                element.appendChild(indexElem);
                arrayContainer.appendChild(element);
            });
        }
        
        // Update the explanation based on current step
        function updateExplanation() {
            stepCounter.textContent = currentStep;
            
            const explanations = [
                "The Cycle-Following Technique is used to rearrange elements in an array in place. Let's see how it works with the array [5, 3, 2, 1, 4] and target indices [4, 0, 1, 2, 3].",
                "First, we'll identify cycles. A cycle is formed by following where each element should go. Let's start with index 0 containing value 5.",
                "Value 5 should go to index 4. Value 4 (at index 4) should go to index 3. Value 1 (at index 3) should go to index 2. Value 2 (at index 2) should go to index 1. Value 3 (at index 1) should go to index 0. This forms our first cycle: 0→4→3→2→1→0.",
                "We'll start the cycle at index 0. We store the value 5 as our temporary value.",
                "We move to where 5 should go: index 4. We take the value 4 at this position and replace it with our temporary value 5.",
                "Now, 4 becomes our new temporary value. We follow where 4 should go: index 3. We replace the value 1 with 4 and make 1 our new temporary value.",
                "Next, we follow where 1 should go: index 2. We replace the value 2 with 1 and make 2 our new temporary value.",
                "We continue, following where 2 should go: index 1. We replace the value 3 with 2 and make 3 our new temporary value.",
                "Finally, we place 3 at index 0, completing the cycle. The array is now [3, 2, 1, 4, 5].",
                "Since we've processed all elements in the array, we have correctly rearranged them according to the target indices.",
                "The final array [3, 2, 1, 4, 5] matches our target arrangement. Each value is now at its correct position according to the mapping."
            ];
            
            explanation.textContent = explanations[currentStep];
            
            // Update cycle indicator
            if (currentStep >= 2 && currentStep <= 8) {
                cycleIndicator.textContent = "Current Cycle: 0→4→3→2→1→0";
            } else {
                cycleIndicator.textContent = "";
            }
        }
        
        // Highlight elements based on the current step
        function updateHighlights() {
            // Remove all highlights
            document.querySelectorAll('.element').forEach(el => {
                el.classList.remove('highlighted');
            });
            
            // Add highlights based on current step
            if (currentStep === 1) {
                // Highlight all elements to show we're analyzing the whole array
                document.querySelectorAll('.element').forEach(el => {
                    el.classList.add('highlighted');
                });
            } else if (currentStep === 2) {
                // Highlight the cycle
                for (let i of [0, 4, 3, 2, 1]) {
                    document.getElementById(`element-${i}`).classList.add('highlighted');
                }
            } else if (currentStep >= 3 && currentStep <= 8) {
                const highlightIndices = {
                    3: [0],
                    4: [0, 4],
                    5: [4, 3],
                    6: [3, 2],
                    7: [2, 1],
                    8: [1, 0]
                };
                
                highlightIndices[currentStep].forEach(idx => {
                    document.getElementById(`element-${idx}`).classList.add('highlighted');
                });
            } else if (currentStep === 9 || currentStep === 10) {
                // Highlight all elements to show the final arrangement
                document.querySelectorAll('.element').forEach(el => {
                    el.classList.add('highlighted');
                });
            }
        }
        
        // Update the array values based on the current step
        function updateArrayValues() {
            if (currentStep <= 3) {
                elementPositions = [...originalArray];
            } else if (currentStep === 4) {
                elementPositions = [5, 3, 2, 1, 5];
            } else if (currentStep === 5) {
                elementPositions = [5, 3, 2, 4, 5];
            } else if (currentStep === 6) {
                elementPositions = [5, 3, 1, 4, 5];
            } else if (currentStep === 7) {
                elementPositions = [5, 2, 1, 4, 5];
            } else if (currentStep >= 8) {
                elementPositions = [3, 2, 1, 4, 5];
            }
            
            // Update the displayed values
            elementPositions.forEach((value, index) => {
                const element = document.getElementById(`element-${index}`);
                if (element) {
                    element.textContent = value;
                    
                    const indexElem = document.createElement('div');
                    indexElem.className = 'index';
                    indexElem.textContent = `Index: ${index}`;
                    
                    // Remove existing index element if it exists
                    const existing = element.querySelector('.index');
                    if (existing) {
                        element.removeChild(existing);
                    }
                    
                    element.appendChild(indexElem);
                }
            });
        }
        
        // Update the entire visualization
        function updateVisualization() {
            updateArrayValues();
            updateHighlights();
            updateExplanation();
            
            // Enable/disable buttons based on current step
            prevBtn.disabled = (currentStep === 0);
            nextBtn.disabled = (currentStep === totalSteps - 1);
        }
        
        // Event listeners
        nextBtn.addEventListener('click', () => {
            if (currentStep < totalSteps - 1) {
                currentStep++;
                updateVisualization();
            }
        });
        
        prevBtn.addEventListener('click', () => {
            if (currentStep > 0) {
                currentStep--;
                updateVisualization();
            }
        });
        
        // Initialize the visualization
        createArrayElements();
        updateVisualization();
    </script>
</body>
</html>